<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Dyna Filter by bmsantos</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Dyna Filter</h1>
        <h2>Dynamic Object filtering for Json</h2>
        <a href="https://github.com/bmsantos/dynafilter-proj" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h3>
<a name="dyna-filter" class="anchor" href="#dyna-filter"><span class="octicon octicon-link"></span></a>Dyna Filter</h3>

<p>Spring Framework extension for JSON Dynamic Object filtering.</p>

<p>This library provides a non-intrusive way to dynamically filter the desired fields to be passed for a serialization mechanism.</p>

<p>Although designed to be used with Json, other serialization mechanism (e.g. binary) could also make use of the filter.</p>

<h4>
<a name="how-it-works" class="anchor" href="#how-it-works"><span class="octicon octicon-link"></span></a>How it works?</h4>

<p>Use the <strong>@DynaFilter</strong> annotation to filter out the fields of interest of any given data type and applied to the usual request handler method:</p>

<div class="highlight highlight-java"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"collection"</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">GET</span><span class="o">,</span> <span class="n">produces</span> <span class="o">=</span> <span class="s">"application/json"</span><span class="o">)</span>
<span class="nd">@DynaFilter</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="n">Data</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"name"</span><span class="o">,</span> <span class="s">"description"</span> <span class="o">},</span> <span class="n">includeNulls</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@ResponseBody</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Data</span><span class="o">&gt;</span> <span class="n">returnCollection</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>

<p>The annotation get's processed by a spring handler when necessary (similar in concept to a interceptor).</p>

<p>To filter multiple data types use <strong>@DynaFilters</strong> to wrap multiple <strong>@DynaFilter</strong> annotations.</p>

<div class="highlight highlight-java"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"hybrid"</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">GET</span><span class="o">,</span> <span class="n">produces</span> <span class="o">=</span> <span class="s">"application/json"</span><span class="o">)</span>
<span class="nd">@DynaFilters</span><span class="o">({</span>
    <span class="nd">@DynaFilter</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="s">"name"</span><span class="o">),</span>
    <span class="nd">@DynaFilter</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="n">Address</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="s">"id"</span><span class="o">)</span>
<span class="o">})</span>
<span class="kd">public</span> <span class="nd">@ResponseBody</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">returnHybrid</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>

<p>For reusability use <strong>@NamedDynaFilters</strong> annotation:</p>

<div class="highlight highlight-java"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"named"</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">GET</span><span class="o">,</span> <span class="n">produces</span> <span class="o">=</span> <span class="s">"application/json"</span><span class="o">)</span>
<span class="nd">@NamedDynaFilters</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"userAge"</span><span class="o">,</span> <span class="s">"addressOnly"</span> <span class="o">})</span>
<span class="kd">public</span> <span class="nd">@ResponseBody</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">shouldUseNamedFitlers</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>

<p>and configure the named filters in the respective factory:</p>

<div class="highlight highlight-xml"><pre>    <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.dynafilter.DynaFilterFactory"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"namedFilters"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;list&gt;</span>
                <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.dynafilter.NamedDynaFilter"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">"userAge"</span> <span class="nt">/&gt;</span> // Filter name
                    <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">"org.dynafilter.controller.User"</span> <span class="nt">/&gt;</span> // Type
                    <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span> // Include nulls
                    <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">"id,age"</span> <span class="nt">/&gt;</span> // Fields
                <span class="nt">&lt;/bean&gt;</span>
                <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.dynafilter.NamedDynaFilter"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">"addressOnly"</span> <span class="nt">/&gt;</span> // Filter name
                    <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">"org.dynafilter.controller.Address"</span> <span class="nt">/&gt;</span> // Type
                    <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">"id,address"</span> <span class="nt">/&gt;</span> // Field
                <span class="nt">&lt;/bean&gt;</span>
            <span class="nt">&lt;/list&gt;</span>
        <span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>
</pre></div>

<h4>
<a name="lookup-strategy" class="anchor" href="#lookup-strategy"><span class="octicon octicon-link"></span></a>Lookup strategy</h4>

<p>When looking for the configured fields, the lookup strategy is the following:</p>

<ol>
<li>Fields/attributes/properties</li>
<li>Access methods (Camel cased methods that start with <em>get</em>) [1]</li>
<li>Exact method (methods with the exact same name) [1]<br>
</li>
</ol><p>[1] Methods must have no arguments </p>

<h4>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h4>

<p>Add the DynaFilterFactory to your Spring MVC Context configuration xml or bean:</p>

<div class="highlight highlight-xml"><pre>    <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.dynafilter.DynaFilterFactory"</span> <span class="nt">/&gt;</span>
</pre></div>

<p>or</p>

<div class="highlight highlight-java"><pre><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppConfig</span> <span class="o">{</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">DynaFilterFactory</span> <span class="nf">DynaFilterFactory</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">DynaFilterFactory</span><span class="o">();</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>

<p>And annotate the controller or any other bean with the one or more filter annotation as shown in the "How it works?" section above.
Make sure you look into the provided test controller and spring context for a working example.</p>

<h4>
<a name="build-project-and-run-tests" class="anchor" href="#build-project-and-run-tests"><span class="octicon octicon-link"></span></a>Build project and run tests</h4>

<pre><code>mvn clean install
</code></pre>

<p>.</p>

<h4>
<a name="manual-test-execution" class="anchor" href="#manual-test-execution"><span class="octicon octicon-link"></span></a>Manual test execution</h4>

<pre><code>cd web-test
mvn jetty:run
</code></pre>

<p>Then point your browser to:</p>

<ol>
<li><a href="http://localhost:8080/jsonfilter/simple">Simple instance with primitive types</a></li>
<li><a href="http://localhost:8080/jsonfilter/collection">Collection of simple instances</a></li>
<li><a href="http://localhost:8080/jsonfilter/hybrid">Collection of mixed simples instances</a></li>
<li><a href="http://localhost:8080/jsonfilter/composite">Graph of complex instance</a></li>
<li><a href="http://localhost:8080/jsonfilter/empty">Fully filtered object</a></li>
<li><a href="http://localhost:8080/jsonfilter/emptyarray">Fully filtered collection</a></li>
<li><a href="http://localhost:8080/jsonfilter/includenulls">Include nulls</a></li>
<li><a href="http://localhost:8080/jsonfilter/named">Named filters</a></li>
<li><a href="http://localhost:8080/jsonfilter/accessors">Method access</a></li>
</ol>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/bmsantos/dynafilter-proj/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/bmsantos/dynafilter-proj/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/bmsantos/dynafilter-proj"></a> is maintained by <a href="https://github.com/bmsantos">bmsantos</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>