<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Dyna Filter by bmsantos</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Dyna Filter</h1>
        <h2>Dynamic Object Filtering</h2>
        <a href="https://github.com/bmsantos/dynafilter-proj" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h3>
<a name="dyna-filter" class="anchor" href="#dyna-filter"><span class="octicon octicon-link"></span></a>Dyna Filter</h3>

<p>Dynamic Object filtering for Json serialization.</p>

<p>This library provides a non-intrusive way to dynamically filter fields for serialization.</p>

<p>Although designed to be used with JSON, any other serialization mechanism (e.g. binary) could also make use of the filter.</p>

<h4>
<a name="current-release" class="anchor" href="#current-release"><span class="octicon octicon-link"></span></a>Current Release</h4>

<div class="highlight highlight-xml"><pre><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.github.bmsantos<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>dynafilter<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>

<h4>
<a name="how-does-it-work" class="anchor" href="#how-does-it-work"><span class="octicon octicon-link"></span></a>How does it work?</h4>

<p>The <strong>@DynaFilter</strong> annotation is used to filter out the fields of interest from any data type and works in conjunction with the usual request handler method:</p>

<div class="highlight highlight-java"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"collection"</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">GET</span><span class="o">,</span> <span class="n">produces</span> <span class="o">=</span> <span class="s">"application/json"</span><span class="o">)</span>
<span class="nd">@DynaFilter</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="n">Data</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"name"</span><span class="o">,</span> <span class="s">"description"</span> <span class="o">},</span> <span class="n">includeNulls</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@ResponseBody</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Data</span><span class="o">&gt;</span> <span class="n">returnCollection</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>

<p>When necessary, the annotation is processed by a Spring handler. This is similar to the mechanism use by an interceptor.</p>

<p>To filter multiple data types use <strong>@DynaFilters</strong> to wrap multiple <strong>@DynaFilter</strong> annotations.</p>

<div class="highlight highlight-java"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"hybrid"</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">GET</span><span class="o">,</span> <span class="n">produces</span> <span class="o">=</span> <span class="s">"application/json"</span><span class="o">)</span>
<span class="nd">@DynaFilters</span><span class="o">({</span>
    <span class="nd">@DynaFilter</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="s">"name"</span><span class="o">),</span>
    <span class="nd">@DynaFilter</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="n">Address</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">fields</span> <span class="o">=</span> <span class="s">"id"</span><span class="o">)</span>
<span class="o">})</span>
<span class="kd">public</span> <span class="nd">@ResponseBody</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">returnHybrid</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>

<p>To use the same filter multiple times, use the <strong>@NamedDynaFilters</strong> annotation:</p>

<div class="highlight highlight-java"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"named"</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">GET</span><span class="o">,</span> <span class="n">produces</span> <span class="o">=</span> <span class="s">"application/json"</span><span class="o">)</span>
<span class="nd">@NamedDynaFilters</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"userAge"</span><span class="o">,</span> <span class="s">"addressOnly"</span> <span class="o">})</span>
<span class="kd">public</span> <span class="nd">@ResponseBody</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">shouldUseNamedFitlers</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>

<p>and configure the named filters in the respective factory:</p>

<div class="highlight highlight-xml"><pre>    <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"com.github.bmsantos.dynafilter.DynaFilterFactory"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"namedFilters"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;list&gt;</span>
                <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"com.github.bmsantos.dynafilter.NamedDynaFilter"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">"userAge"</span> <span class="nt">/&gt;</span> // Filter name
                    <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">"com.github.bmsantos.dynafilter.controller.User"</span> <span class="nt">/&gt;</span> // Type
                    <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span> // Include nulls
                    <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">"id,age"</span> <span class="nt">/&gt;</span> // Fields
                <span class="nt">&lt;/bean&gt;</span>
                <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"com.github.bmsantos.dynafilter.NamedDynaFilter"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">"addressOnly"</span> <span class="nt">/&gt;</span> // Filter name
                    <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">"com.github.bmsantos.dynafilter.controller.Address"</span> <span class="nt">/&gt;</span> // Type
                    <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">"id,address"</span> <span class="nt">/&gt;</span> // Field
                <span class="nt">&lt;/bean&gt;</span>
            <span class="nt">&lt;/list&gt;</span>
        <span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>
</pre></div>

<h4>
<a name="lookup-strategy" class="anchor" href="#lookup-strategy"><span class="octicon octicon-link"></span></a>Lookup strategy</h4>

<p>When looking for fields listed in the annotation, the following lookup strategy is used:</p>

<ol>
<li>Fields/attributes/properties</li>
<li>Access methods (Camel cased methods that start with <em>get</em>) [1]</li>
<li>Exact method (methods with the exact same name) [1]<br>
</li>
</ol><p>[1] Methods must have no arguments </p>

<h4>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h4>

<p>Add the DynaFilterFactory to your Spring MVC Context configuration XML or bean:</p>

<div class="highlight highlight-xml"><pre>    <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"com.github.bmsantos.dynafilter.DynaFilterFactory"</span> <span class="nt">/&gt;</span>
</pre></div>

<p>or</p>

<div class="highlight highlight-java"><pre><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppConfig</span> <span class="o">{</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">DynaFilterFactory</span> <span class="nf">DynaFilterFactory</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">DynaFilterFactory</span><span class="o">();</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>

<p>Annotate the controller or any other bean with one or more filter annotations as shown in the "How does it work?" section above.
The provided test controller and Spring context files demonstrate how easy it is with a working example.</p>

<h4>
<a name="build-project-and-run-tests" class="anchor" href="#build-project-and-run-tests"><span class="octicon octicon-link"></span></a>Build project and run tests</h4>

<pre><code>mvn clean install
</code></pre>

<h4>
<a name="manual-test-execution" class="anchor" href="#manual-test-execution"><span class="octicon octicon-link"></span></a>Manual test execution</h4>

<pre><code>cd web-test
mvn jetty:run
</code></pre>

<p>Then use the following links to see examples of:</p>

<ol>
<li><a href="http://localhost:8080/jsonfilter/simple">Simple instance with primitive types</a></li>
<li><a href="http://localhost:8080/jsonfilter/collection">Collection of simple instances</a></li>
<li><a href="http://localhost:8080/jsonfilter/hybrid">Collection of mixed simples instances</a></li>
<li><a href="http://localhost:8080/jsonfilter/composite">Graph of complex instance</a></li>
<li><a href="http://localhost:8080/jsonfilter/empty">Fully filtered object</a></li>
<li><a href="http://localhost:8080/jsonfilter/emptyarray">Fully filtered collection</a></li>
<li><a href="http://localhost:8080/jsonfilter/includenulls">Include nulls</a></li>
<li><a href="http://localhost:8080/jsonfilter/named">Named filters</a></li>
<li><a href="http://localhost:8080/jsonfilter/accessors">Method access</a></li>
</ol>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/bmsantos/dynafilter-proj/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/bmsantos/dynafilter-proj/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/bmsantos/dynafilter-proj"></a> is maintained by <a href="https://github.com/bmsantos">bmsantos</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>